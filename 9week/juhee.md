## 1. 통계정보와 비용계산 원리

선택도와 카디널리티

선택도 : 전체 레코드 중에서 조건절에 의해 선택 되는 레코드 비율을 말한다.

카디널리티 : 전체 레코드 중에서 조건절에 의해 선택 되는 레코드 개수 이다.

옵티마이저는 이렇게 카디널리티를 구하고 그만큼의 데이터를 액세스 하는데비용을 계산해 액세스 방식과 조인 순서 방식등을 계산한다.

통계정보

- 통계정보를 수집하는 명령어가 있다.
- 테이블 통계와 인덱스 통계 컬럼 통계를 확인할 수 있다. 또한 시스템 통계를 통해 애플리케이션 및 하드웨어의 성능을 특성할 수 있다.

컬럼 히스토 그램

데이터 분표가 균일하지 않은 경우 컬럼 통계 외에 실행 계획을 함께 활용한다.

비용 계산 원리

인덱스 키 값을 모두 ‘=’조건으로 검색하는 경우는

비용 = BLEVEL + AVG_LEAF_LOCKS_PER_KEY + AVG_DATA_BLOCKS_PER_KEY

로 계산할 수 있다.

## 2. 옵티마이저에 대한 이해

옵티마이저 종류

- 비용기반 옵티마이저
- 규칙기반 옵티마이저

옵티 마이저 모드

- 비용기반 옵티 마이저
    - 전체 처리속도 최적화
    - 최초 응답속도 최적화
    - 최초 N건 응답속도 최적화

옵티마이저에 영향을 미치는 요소

- SQL과 연산자 형태
- 인덱스, IOT, 클러스터, 파티션 ,MV등 옵티마이저 팩터
- 제약 설정
- 통계정보
- 옵티마이저 힌트
- 옵티마이저 관련 파라미터

옵티마이저의 한계

- 항상 최선을 아니다.
- 기본적으로는 비용기반으로 행동하지만 내부적으로 여러 가정과 정해진 규칙을 이용해 기계적인 선택을 한다는것도 한계 중 한 가지 이다.

개발자의 역할

- 개발자 스스로 옵티마이저가 되어야 한다. 능력이 없어 맡기는 것이 아니라 바빠서 맡긴다고 생각하자.

옵티마이저를 최적화 하기 위해 개발자가 할 수 있는 일

- 필요한 최소 블록만 읽도록 쿼리 성
- 최적의 옵티마이징 팩터 제공
- 필요하다면, 옵티마이저 힌트를 사용해 최적의 액세스 경로로 유동한다.